# PreID Labeling GUI : a Tracking and Re-Identification Annotation Tool

PreID Labeling GUI is a graphical user interface (GUI) tool designed to annotate and refine tracking and re-identification data in videos. It enables users to enhance bounding box annotations, correct ID assignments, and resolve common issues like flickering in annotated data. This tool is particularly useful for manually refining annotations generated by automated systems (e.g. DeepSORT). It simplifies the process of assigning identity labels, making it easier to prepare datasets for training and evaluation in computer vision projects.

---

## Features

### 1. Bounding Box Creation and Adjustment
- Manually draw or refine bounding boxes around individuals (objects instances) in video frames.

### 2. ID Assignment and Correction
- Assign unique IDs to individuals.
- Correct mismatched or erroneous ID assignments.

### 3. Flickering Issue Correction
- Interpolate missing bounding boxes to fix gaps in detections across consecutive frames.

### 4. Video Playback and Annotation
- Visually inspect video frames to validate and refine annotations.

### 5. .JSON and .TXT File Modification
- Load `.json` or `.txt` files containing annotation data and make changes to bounding boxes (`BboxP`), IDs, or both. The tool supports `.txt` files in MOT16 Challenge format, which will be converted to the `.json` format upon saving.

### 6. Save and Export Refined Annotations
- Save updated `.json` file. The video with annotations (IDs and bounding boxes) is also saved.

---

## Input Formats

### JSON Format
The tool accepts `.json` files with the following structure:

```json
{
  "frame_number": [
    {
      "id": <object_id>,
      "BboxP": [<x1>, <y1>, <x2>, <y2>]
    },
    ...
  ],
  ...
}
```

- **`frame_number`**: Represents the frame number in the video.
- **`id`**: Unique identifier for an individual in the bounding box.
- **`BboxP`**: Bounding box coordinates `[x1, y1, x2, y2]`.

### TXT Format (MOT16 Challenge)
The tool also accepts `.txt` files in the MOT16 Challenge format. These files are parsed and converted into the required `.json` format. Below is the expected `.txt` format structure:

- Each line contains:
  ```
  <frame>,<id>,<x>,<y>,<width>,<height>,...
  ```

---

## Installation

1. Clone this repository:
   ```bash
   git clone https://github.com/bdager/preid-labeling-gui.git
   cd preid-labeling-gui
   ```
2. Install the required dependencies:
   ```bash
   pip install -r requirements.txt
   ```

---

## Usage

1. Launch the GUI:
   ```bash
   python run_gui.py
   ```

2. Select the video file to annotate or correct.

3. Load the annotation file:
   - `.json` format for existing annotations.
   - `.txt` format in MOT16 Challenge structure (will be converted to `.json` upon saving).

4. Perform necessary corrections:
   - Adjust/add/delet bounding boxes.
   - Correct ID assignments.
   - Fix flickering issues.

5. Save the updated `.json` file and the video with the annotations in a directory.

---

## Example Workflow

1. Open a video file in the GUI.
2. Load the corresponding `.json` or `.txt` file with existing annotations.
3. Manually adjust the annotations by creating or refining bounding boxes, correcting IDs, or addressing missing detections.
4. Save the refined annotations for subsequent use.

---

## Notes

- This tool is optimized for tracking and re-identification tasks.
- Ensure the input files adhere to the specified formats for compatibility.
- Designed to refine outputs from automated systems like DeepSORT.

---

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

---

## Contributions

Contributions are welcome! Feel free to open issues or submit pull requests to improve the tool.

---

## Contact

For any questions or support, please contact [bessie.dominguez@ua.es].

